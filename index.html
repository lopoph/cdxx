<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>ä¿®ä»™è®¡ç®—å™¨</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
  
/* æ‰«é›·æ¸¸æˆæ ·å¼ */
.mine-icon {
  position: fixed;
  top: 20px;
  right: 20px;
  width: 40px;
  height: 40px;
  background-color: #ff5555;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: bold;
  cursor: pointer;
  z-index: 1000;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.mine-game {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: white;
  z-index: 1001;
  padding: 20px;
  box-sizing: border-box;
  overflow: auto;
}

.mine-title {
  text-align: center;
  font-size: 2rem;
  margin-bottom: 20px;
  color: #4a6fa5;
}

.difficulty-selector {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-bottom: 30px;
}

.difficulty-btn {
  padding: 10px 20px;
  background-color: #4a6fa5;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 1rem;
}

.game-info-container {
  display: flex;
  flex-direction: column;
  height: calc(100% - 150px);
}

.game-info-container.hidden {
  display: none;
}

.game-info {
  display: flex;
  flex-direction: column;
  margin-bottom: 10px;
}

.mine-time-row {
  display: flex;
  justify-content: space-between;
  width: 100%;
  margin-bottom: 5px;
}

#mine-count, #game-time {
  min-width: 120px;
  font-size: 1.1rem;
}

#mine-count {
  text-align: left;
}

#game-time {
  text-align: right;
}

.flag-mode-row {
  display: flex;
  justify-content: center;
  width: 100%;
}

.mine-board {
  display: grid;
  grid-template-columns: repeat(var(--cols, 8), 1fr);
  gap: 2px;
  margin: 0 auto;
  width: 90%;
  max-width: 100%;
  flex-grow: 1;
}

.mine-cell {
  aspect-ratio: 1;
  background-color: #e0e0e0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  cursor: pointer;
  user-select: none;
  position: relative;
  overflow: hidden;
}

.mine-cell span {
  display: inline-block;
  transform: scale(0.85);
  line-height: 1;
}

.mine-board.easy .mine-cell {
  font-size: 24px;
}

.mine-board.medium .mine-cell {
  font-size: 18px;
}

.mine-board.hard .mine-cell {
  font-size: 14px;
}

.mine-cell.revealed {
  background-color: #f5f5f5;
}

.mine-cell.flagged {
  background-color: #ffcccc;
}

.mine-cell.mine {
  background-color: #ff5555;
  color: white;
}

/* ç²¾å‡†å®šä½æ’æ——æŒ‰é’®æ ·å¼ */
#flag-mode-btn {
  padding: 4px 10px !important;      /* å…³é”®è°ƒæ•´ï¼šå‡å°‘å†…è¾¹è· */
  margin: 0 auto !important;          /* ç¡®ä¿å±…ä¸­ä¸å—å½±å“ */
  background-color: #4a6fa5 !important;
  color: white !important;
  border: none !important;
  border-radius: 4px !important;
  font-size: 0.95rem !important;      /* å¾®è°ƒå­—ä½“å¤§å° */
  line-height: 1.25 !important;       /* ç²¾å‡†æ§åˆ¶è¡Œé«˜ */
  box-shadow: none !important;        /* ç§»é™¤å¯èƒ½å¹²æ‰°çš„é˜´å½± */
  width: auto !important;             /* å–æ¶ˆå›ºå®šå®½åº¦ */
  display: inline-block !important;    /* é¿å…flexå¸ƒå±€å½±å“ */
}

#flag-mode-btn.active {
  background-color: #ff5555 !important;
  padding: 4px 10px !important;       /* æ¿€æ´»çŠ¶æ€ä¿æŒç›¸åŒå†…è¾¹è· */
}

/* ç¡®ä¿æŒ‰é’®å®¹å™¨ä¸é™åˆ¶å®½åº¦ */
.flag-mode-row {
  padding: 0 !important;
  margin: 5px 0 !important;
}



.game-controls {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 20px;
}

.control-btn {
  padding: 10px 20px;
  background-color: #4a6fa5;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 1rem;
}

.exit-btn {
  background-color: #ff5555;
}
/* æ•°å­—é¢œè‰²æ ·å¼ */
.mine-cell .number-1 {
  color: #0000FF; /* è“è‰² */
}

.mine-cell .number-2 {
  color: #008000; /* ç»¿è‰² */
}

.mine-cell .number-3 {
  color: #FF0000; /* çº¢è‰² */
}

.mine-cell .number-4 {
  color: #800080; /* ç´«è‰² */
}

.mine-cell .number-5 {
  color: #800000; /* æ —è‰² */
}



  /* è¿™ä¸ªå¥½æƒ³å’ŒéŸ³ä¹æœ‰å…³ ä¸æ¸…æ¥šå¹²å˜›çš„*/
.rotating-image {
    animation: rotation 3s infinite linear;
    display: inline-block;
    vertical-align: middle;
}

@keyframes rotation {
    from {
        transform: rotate(0deg);
    }
    to {
        transform: rotate(359deg);
    }
}

    body {
      font-family: 'Microsoft YaHei', Arial, sans-serif;
      background-color: #f5f7fa;
      color: #333;
      line-height: 1.6;
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
      touch-action: pan-y;
      overflow-x: hidden;
    }
h1 {
  color: #4a6fa5;
  text-align: center;
  margin-bottom: 20; /* æ”¹ä¸º0æ¶ˆé™¤ä¸‹è¾¹è· */
  padding-bottom: 0px; /* å¯é€‰ï¼šå¦‚æœéœ€è¦ä¸€ç‚¹é—´è·ï¼Œå¯ä»¥ç”¨paddingä»£æ›¿ */
}
.qq-group-section {
  margin: 10px auto; /* ä¸Šä¸‹è¾¹è·æ”¹ä¸º0 */
  padding: 5px 10px; /* å‡å°‘å†…è¾¹è· */
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

    
    /* æ ‡ç­¾é¡µå®¹å™¨ä¼˜åŒ– */
    .tab-container {
      display: flex;
      margin-bottom: 10px;
      width: 100%;
      height: 50px;
    }
    .tab {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #e0e0e0;
      cursor: pointer;
      border-radius: 5px 5px 0 0;
      margin-right: 5px;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    .tab.active {
      background-color: #4a6fa5;
      color: white;
    }
    .tab:hover {
      background-color: #d0d0d0;
    }
    .tab.active:hover {
      background-color: #3a5f95;
    }
    
    /* å†…å®¹åŒºåŸŸæ»‘åŠ¨åŠ¨ç”» */
    .content-container {
      position: relative;
      overflow: hidden;
      height: auto;
      touch-action: pan-y;
    }
    .tab-content {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      opacity: 0;
      transform: translateX(100%);
      transition: transform 0.4s ease, opacity 0.4s ease;
      pointer-events: none;
    }
    .tab-content.active {
      position: relative;
      opacity: 1;
      transform: translateX(0);
      pointer-events: all;
    }
    .tab-content.slide-left {
      transform: translateX(-100%);
    }
    .tab-content.slide-right {
      transform: translateX(100%);
    }
    
    .input-section {
      background-color: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
      margin-bottom: 20px;
      touch-action: pan-y;
    }
    .input-group {
      margin-bottom: 15px;
    }
    .input-row {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
    label {
      font-weight: bold;
      color: #4a6fa5;
      min-width: 80px;
    }
    input[type="number"] {
      width: 100px;
      padding: 8px;
      border: 1px solid #e0e0e0;
      border-radius: 5px;
      margin-right: 10px;
    }
    select {
      padding: 8px;
      border: 1px solid #e0e0e0;
      border-radius: 5px;
      width: 90px; /* å‡å°‘10% */
      margin-left: -3%; /* å‘å·¦ç§»åŠ¨3% */
    }
    button {
      padding: 12px;
      background-color: #4a6fa5;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 1rem;
      cursor: pointer;
      width: 100%;
    }
    .result-section {
      background: linear-gradient(135deg, #f0f4ff, #e6eeff);
      border-radius: 10px;
      padding: 20px;
    }
    .result-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    .result-label {
      font-weight: bold;
    }
    .result-value {
      font-weight: bold;
      color: #4a6fa5;
    }
    .dan-value {
      color: #d63384;
      font-weight: bold;
    }
    .hidden {
      display: none;
    }
    .hint {
      font-size: 0.8rem;
      color: #888;
      margin-left: 5px;
    }
    
    /* åŠ æˆåŒºåŸŸæ ·å¼ */
    .bonus-container {
      display: flex;
      gap: 20px;
      margin-bottom: 15px;
      margin-left: -4%; /* å‘å·¦ç§»åŠ¨4% */
    }
    .bonus-box {
      flex: 1;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 15px;
    }
    .life-bonus {
      background-color: #e6f7e6;
    }
    .attack-bonus {
      background-color: #ffe6e6;
    }
    .bonus-title {
      text-align: center;
      font-weight: bold;
      margin-bottom: 15px;
      font-size: 1.1rem;
    }
    .bonus-input-group {
      margin-bottom: 10px;
    }
    .bonus-label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    .bonus-input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
    }
    .bonus-hint {
      text-align: center;
      font-size: 0.8rem;
      color: #888;
      margin-top: 10px;
    }
    
    .music-controls {
      display: none;
    }
    
    /* æ–°å¢æ ·å¼ï¼šåŸºç¡€ç”Ÿå‘½å’ŒåŸºç¡€æ”»å‡»èƒŒæ™¯ç°è‰²ï¼Œè¾“å…¥æ¡†å‡å°‘30% */
    .base-attributes-group {
      background-color: #f0f0f0;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
    }
    .base-attributes-group .input-row input[type="number"] {
      width: 70px; /* å‡å°‘30% */
    }
    
    /* ç›®æ ‡æˆ˜åŠ›èƒŒæ™¯ç°è‰²ï¼Œè¾“å…¥æ¡†å‡å°‘30% */
    .target-power-group {
      background-color: #f0f0f0;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
    }
    .target-power-group .input-row input[type="number"] {
      width: 70px; /* å‡å°‘30% */
    }
    
    /* åˆå§‹æˆ˜åŠ›å’Œç›®æ ‡æˆ˜åŠ›èƒŒæ™¯ç°è‰²ï¼Œè¾“å…¥æ¡†å‡å°‘30% */
    .bath-power-group {
      background-color: #f0f0f0;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
    }
    .bath-power-group .input-row input[type="number"] {
      width: 70px; /* å‡å°‘30% */
    }
    
    /* æ¯äº”ç§’èƒŒæ™¯ç°è‰²ï¼Œè¾“å…¥æ¡†å‡å°‘30% */
    .growth-rate-group {
      background-color: #f0f0f0;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
    }
    .growth-rate-group .input-row input[type="number"] {
      width: 70px; /* å‡å°‘30% */
    }



.copy-btn {
  padding: 2px 8px;
  background: #4a6fa5;
  color: white;
  border: none;
  border-radius: 3px;
  cursor: pointer;
  width: auto; /* è‡ªåŠ¨å®½åº¦ */
  min-width: 40px; /* åˆšå¥½å®¹çº³"å¤åˆ¶"ä¸¤å­— */
  white-space: nowrap; /* é˜²æ­¢æ–‡å­—æ¢è¡Œ */
}

  </style>
</head>

<body>




<h1 style="display: flex; align-items: center; justify-content: center;">
  <i class="fas fa-yin-yang rotating-image" style="color: #4a6fa5; font-size: 40px; margin-right: 15px;"></i>
  ä¿®ä»™è®¡ç®—å™¨
</h1>

  
  <div class="qq-group-section">
  <span>æœ‰è¦æ”¹è¿›çš„åœ°æ–¹å¯è¿›QQç¾¤è¯´ï¼š371408377</span>
  <button onclick="copyQQGroup()" class="copy-btn">å¤åˆ¶</button>
</div> 

  <div class="tab-container">
    <div class="tab active" onclick="switchTab('power', 0)">æˆ˜åŠ›</div>
    <div class="tab" onclick="switchTab('base', 1)">åŸºç¡€</div>
    <div class="tab" onclick="switchTab('bath', 2)">æ³¡æ¾¡</div>
  </div>

  <div class="content-container" id="content-container">
    <div class="input-section">
      <!-- æˆ˜åŠ›è®¡ç®— -->
      <div id="power-tab" class="tab-content active">
        <!-- åŸºç¡€ç”Ÿå‘½å’ŒåŸºç¡€æ”»å‡» - èƒŒæ™¯ç°è‰²ï¼Œè¾“å…¥æ¡†å‡å°‘30% -->
        <div class="base-attributes-group">
          <div class="input-group">
            <div class="input-row">
              <label>åŸºç¡€ç”Ÿå‘½ï¼š</label>
              <input type="number" id="base-life" step="0.01" placeholder="è¾“å…¥æ•°å€¼">
              <select id="base-life-unit">
                <option value="1" selected>ä¸ª</option>
                <option value="10000">ä¸‡</option>
                <option value="100000000">äº¿</option>
                <option value="1000000000000">å…†</option>
                <option value="10000000000000000">äº¬</option>
                <option value="100000000000000000000">å“</option>
                <option value="1000000000000000000000000">ç§­</option>
                <option value="10000000000000000000000000000">ç©°</option>
                <option value="100000000000000000000000000000000">æ²Ÿ</option>
                <option value="1000000000000000000000000000000000000">æ¶§</option>
                <option value="10000000000000000000000000000000000000000">æ­£</option>
                <option value="100000000000000000000000000000000000000000000">è½½</option>
                <option value="1000000000000000000000000000000000000000000000000">æ</option>
                <option value="10000000000000000000000000000000000000000000000000000">æ’æ²³æ²™</option>
                <option value="100000000000000000000000000000000000000000000000000000000">é˜¿åƒ§ç¥‡</option>
                <option value="1000000000000000000000000000000000000000000000000000000000000">é‚£ç”±ä»–</option>
                <option value="10000000000000000000000000000000000000000000000000000000000000000">ä¸å¯æ€è®®</option>
                <option value="100000000000000000000000000000000000000000000000000000000000000000000">æ— é‡</option>
                <option value="1000000000000000000000000000000000000000000000000000000000000000000000000">å¤§æ•°</option>
                <option value="10000000000000000000000000000000000000000000000000000000000000000000000000000">æ— æ•Œ</option>
              </select>
            </div>
            <div class="input-row">
              <label>åŸºç¡€æ”»å‡»ï¼š</label>
              <input type="number" id="base-attack" step="0.01" placeholder="è¾“å…¥æ•°å€¼">
              <select id="base-attack-unit">
                <option value="1" selected>ä¸ª</option>
                <option value="10000">ä¸‡</option>
                <option value="100000000">äº¿</option>
                <option value="1000000000000">å…†</option>
                <option value="10000000000000000">äº¬</option>
                <option value="100000000000000000000">å“</option>
                <option value="1000000000000000000000000">ç§­</option>
                <option value="10000000000000000000000000000">ç©°</option>
                <option value="100000000000000000000000000000000">æ²Ÿ</option>
                <option value="1000000000000000000000000000000000000">æ¶§</option>
                <option value="10000000000000000000000000000000000000000">æ­£</option>
                <option value="100000000000000000000000000000000000000000000">è½½</option>
                <option value="1000000000000000000000000000000000000000000000000">æ</option>
                <option value="10000000000000000000000000000000000000000000000000000">æ’æ²³æ²™</option>
                <option value="100000000000000000000000000000000000000000000000000000000">é˜¿åƒ§ç¥‡</option>
                <option value="1000000000000000000000000000000000000000000000000000000000000">é‚£ç”±ä»–</option>
                <option value="10000000000000000000000000000000000000000000000000000000000000000">ä¸å¯æ€è®®</option>
                <option value="100000000000000000000000000000000000000000000000000000000000000000000">æ— é‡</option>
                <option value="1000000000000000000000000000000000000000000000000000000000000000000000000">å¤§æ•°</option>
                <option value="10000000000000000000000000000000000000000000000000000000000000000000000000000">æ— æ•Œ</option>
              </select>
            </div>
          </div>
        </div>

        <div class="bonus-container">
          <div class="bonus-box life-bonus">
            <div class="bonus-title">ç”Ÿå‘½</div>
            <div class="bonus-input-group">
              <label class="bonus-label">åŠ æˆï¼š</label>
              <input type="number" id="life-bonus" step="0.01" placeholder="è¾“å…¥ç™¾åˆ†æ¯”" class="bonus-input">
            </div>
            <div class="bonus-input-group">
              <label class="bonus-label">æå‡ï¼š</label>
             <input type="number" id="life-boost" step="0.01" placeholder="è¾“å…¥ç™¾åˆ†æ¯”" class="bonus-input" oninput="syncBoostValues('power', 'life', this.value)">


            </div>
            <div class="bonus-input-group">
              <label class="bonus-label">å¢å¹…ï¼š</label>
              <input type="number" id="life-amplify" step="0.01" placeholder="è¾“å…¥ç™¾åˆ†æ¯”" class="bonus-input">
            </div>
          </div>
          
          <div class="bonus-box attack-bonus">
            <div class="bonus-title">æ”»å‡»</div>
            <div class="bonus-input-group">
              <label class="bonus-label">åŠ æˆï¼š</label>
              <input type="number" id="attack-bonus" step="0.01" placeholder="è¾“å…¥ç™¾åˆ†æ¯”" class="bonus-input">
            </div>
            <div class="bonus-input-group">
              <label class="bonus-label">æå‡ï¼š</label>
              <input type="number" id="attack-boost" step="0.01" placeholder="è¾“å…¥ç™¾åˆ†æ¯”" class="bonus-input" oninput="syncBoostValues('power', 'attack', this.value)">

            </div>
            <div class="bonus-input-group">
              <label class="bonus-label">å¢å¹…ï¼š</label>
              <input type="number" id="attack-amplify" step="0.01" placeholder="è¾“å…¥ç™¾åˆ†æ¯”" class="bonus-input">
            </div>
          </div>
        </div>
        <div class="bonus-hint">ä¸å¡«é»˜è®¤ä¸º0</div>

        <button onclick="calculatePower()">è®¡ç®—æˆ˜åŠ›</button>
      </div>

      <!-- åŸºç¡€åæ¨ -->
      <div id="base-tab" class="tab-content">
        <!-- ç›®æ ‡æˆ˜åŠ› - èƒŒæ™¯ç°è‰²ï¼Œè¾“å…¥æ¡†å‡å°‘30% -->
        <div class="target-power-group">
          <div class="input-group">
            <div class="input-row">
              <label>ç›®æ ‡æˆ˜åŠ›ï¼š</label>
              <input type="number" id="target-power" step="0.01" placeholder="è¾“å…¥æ•°å€¼">
              <select id="power-unit">
                <option value="1" selected>ä¸ª</option>
                <option value="10000">ä¸‡</option>
                <option value="100000000">äº¿</option>
                <option value="1000000000000">å…†</option>
                <option value="10000000000000000">äº¬</option>
                <option value="100000000000000000000">å“</option>
                <option value="1000000000000000000000000">ç§­</option>
                <option value="10000000000000000000000000000">ç©°</option>
                <option value="100000000000000000000000000000000">æ²Ÿ</option>
                <option value="1000000000000000000000000000000000000">æ¶§</option>
                <option value="10000000000000000000000000000000000000000">æ­£</option>
                <option value="100000000000000000000000000000000000000000000">è½½</option>
                <option value="1000000000000000000000000000000000000000000000000">æ</option>
                <option value="10000000000000000000000000000000000000000000000000000">æ’æ²³æ²™</option>
                <option value="100000000000000000000000000000000000000000000000000000000">é˜¿åƒ§ç¥‡</option>
                <option value="1000000000000000000000000000000000000000000000000000000000000">é‚£ç”±ä»–</option>
                <option value="10000000000000000000000000000000000000000000000000000000000000000">ä¸å¯æ€è®®</option>
                <option value="100000000000000000000000000000000000000000000000000000000000000000000">æ— é‡</option>
                <option value="1000000000000000000000000000000000000000000000000000000000000000000000000">å¤§æ•°</option>
                <option value="10000000000000000000000000000000000000000000000000000000000000000000000000000">æ— æ•Œ</option>
              </select>
            </div>
          </div>
        </div>

        <div class="bonus-container">
          <div class="bonus-box life-bonus">
            <div class="bonus-title">ç”Ÿå‘½</div>
            <div class="bonus-input-group">
              <label class="bonus-label">åŠ æˆï¼š</label>
              <input type="number" id="reverse-life-bonus" step="0.01" placeholder="è¾“å…¥ç™¾åˆ†æ¯”" class="bonus-input">
            </div>
            <div class="bonus-input-group">
              <label class="bonus-label">æå‡ï¼š</label>
              <input type="number" id="reverse-life-boost" step="0.01" placeholder="è¾“å…¥ç™¾åˆ†æ¯”" class="bonus-input" oninput="syncBoostValues('base', 'life', this.value)">


            </div>
            <div class="bonus-input-group">
              <label class="bonus-label">å¢å¹…ï¼š</label>
              <input type="number" id="reverse-life-amplify" step="0.01" placeholder="è¾“å…¥ç™¾åˆ†æ¯”" class="bonus-input">
            </div>
          </div>
          
          <div class="bonus-box attack-bonus">
            <div class="bonus-title">æ”»å‡»</div>
            <div class="bonus-input-group">
              <label class="bonus-label">åŠ æˆï¼š</label>
              <input type="number" id="reverse-attack-bonus" step="0.01" placeholder="è¾“å…¥ç™¾åˆ†æ¯”" class="bonus-input">
            </div>
            <div class="bonus-input-group">
              <label class="bonus-label">æå‡ï¼š</label>
              <input type="number" id="reverse-attack-boost" step="0.01" placeholder="è¾“å…¥ç™¾åˆ†æ¯”" class="bonus-input" oninput="syncBoostValues('base', 'attack', this.value)">


            </div>
            <div class="bonus-input-group">
              <label class="bonus-label">å¢å¹…ï¼š</label>
              <input type="number" id="reverse-attack-amplify" step="0.01" placeholder="è¾“å…¥ç™¾åˆ†æ¯”" class="bonus-input">
            </div>
          </div>
        </div>
        <div class="bonus-hint">ä¸å¡«é»˜è®¤ä¸º0</div>

        <button onclick="reverseCalculate()">åæ¨åŸºç¡€å±æ€§</button>
      </div>

      <!-- æ³¡æ¾¡è®¡ç®— -->
      <div id="bath-tab" class="tab-content">
        <!-- åˆå§‹æˆ˜åŠ›å’Œç›®æ ‡æˆ˜åŠ› - èƒŒæ™¯ç°è‰²ï¼Œè¾“å…¥æ¡†å‡å°‘30% -->
        <div class="bath-power-group">
          <div class="input-group">
            <div class="input-row">
              <label>åˆå§‹æˆ˜åŠ›ï¼š</label>
              <input type="number" id="initial-power-bath" step="0.01" placeholder="è¾“å…¥æ•°å€¼">
              <select id="initial-power-unit-bath">
                <option value="1" selected>ä¸ª</option>
                <option value="10000">ä¸‡</option>
                <option value="100000000">äº¿</option>
                <option value="1000000000000">å…†</option>
                <option value="10000000000000000">äº¬</option>
                <option value="100000000000000000000">å“</option>
                <option value="1000000000000000000000000">ç§­</option>
                <option value="10000000000000000000000000000">ç©°</option>
                <option value="100000000000000000000000000000000">æ²Ÿ</option>
                <option value="1000000000000000000000000000000000000">æ¶§</option>
                <option value="10000000000000000000000000000000000000000">æ­£</option>
                <option value="100000000000000000000000000000000000000000000">è½½</option>
                <option value="1000000000000000000000000000000000000000000000000">æ</option>
                <option value="10000000000000000000000000000000000000000000000000000">æ’æ²³æ²™</option>
                <option value="100000000000000000000000000000000000000000000000000000000">é˜¿åƒ§ç¥‡</option>
                <option value="1000000000000000000000000000000000000000000000000000000000000">é‚£ç”±ä»–</option>
                <option value="10000000000000000000000000000000000000000000000000000000000000000">ä¸å¯æ€è®®</option>
                <option value="100000000000000000000000000000000000000000000000000000000000000000000">æ— é‡</option>
                <option value="1000000000000000000000000000000000000000000000000000000000000000000000000">å¤§æ•°</option>
                <option value="10000000000000000000000000000000000000000000000000000000000000000000000000000">æ— æ•Œ</option>
              </select>
            </div>
            <div class="input-row">
              <label>ç›®æ ‡æˆ˜åŠ›ï¼š</label>
              <input type="number" id="target-power-bath" step="0.01" placeholder="è¾“å…¥æ•°å€¼">
              <select id="target-power-unit-bath">
                <option value="1" selected>ä¸ª</option>
                <option value="10000">ä¸‡</option>
                <option value="100000000">äº¿</option>
                <option value="1000000000000">å…†</option>
                <option value="10000000000000000">äº¬</option>
                <option value="100000000000000000000">å“</option>
                <option value="1000000000000000000000000">ç§­</option>
                <option value="10000000000000000000000000000">ç©°</option>
                <option value="100000000000000000000000000000000">æ²Ÿ</option>
                <option value="1000000000000000000000000000000000000">æ¶§</option>
                <option value="10000000000000000000000000000000000000000">æ­£</option>
                <option value="100000000000000000000000000000000000000000000">è½½</option>
                <option value="1000000000000000000000000000000000000000000000000">æ</option>
                <option value="10000000000000000000000000000000000000000000000000000">æ’æ²³æ²™</option>
                <option value="100000000000000000000000000000000000000000000000000000000">é˜¿åƒ§ç¥‡</option>
                <option value="1000000000000000000000000000000000000000000000000000000000000">é‚£ç”±ä»–</option>
                <option value="10000000000000000000000000000000000000000000000000000000000000000">ä¸å¯æ€è®®</option>
                <option value="100000000000000000000000000000000000000000000000000000000000000000000">æ— é‡</option>
                <option value="1000000000000000000000000000000000000000000000000000000000000000000000000">å¤§æ•°</option>
                <option value="10000000000000000000000000000000000000000000000000000000000000000000000000000">æ— æ•Œ</option>
              </select>
            </div>
          </div>
        </div>

        <!-- æ¯äº”ç§’ - èƒŒæ™¯ç°è‰²ï¼Œè¾“å…¥æ¡†å‡å°‘30% -->
        <div class="growth-rate-group">
          <div class="input-group">
            <div class="input-row">
              <label>æ¯æ¬¡å¢åŠ ï¼š</label>
              <input type="number" id="growth-rate" min="0.01" max="0.02" step="0.001" value="0.01" placeholder="è¾“å…¥ç™¾åˆ†æ¯”">
              <span class="hint">(0.01%-0.02%)</span>
            </div>
          </div>
        </div>

        <button onclick="calculateBath()">è®¡ç®—æ³¡æ¾¡éœ€æ±‚</button>
      </div>
    </div>
  </div>

  <!-- æˆ˜åŠ›è®¡ç®—ç»“æœ -->
  <div class="result-section hidden" id="power-result-section">
    <h2>æˆ˜åŠ›ç»“æœ</h2>
    <div class="result-row">
      <span class="result-label">æœ€ç»ˆç”Ÿå‘½ï¼š</span>
      <span id="final-life" class="result-value">0 ä¸ª</span>
    </div>
    <div class="result-row">
      <span class="result-label">æœ€ç»ˆæ”»å‡»ï¼š</span>
      <span id="final-attack" class="result-value">0 ä¸ª</span>
    </div>
    <div class="result-row">
      <span class="result-label">æ€»æˆ˜åŠ›ï¼š</span>
      <span id="total-power" class="result-value">0 ä¸ª</span>
    </div>
  </div>

  <!-- åŸºç¡€åæ¨ç»“æœ -->
  <div class="result-section hidden" id="base-result-section">
    <h2>åæ¨ç»“æœ</h2>
    <div class="result-row">
      <span class="result-label">åŸºç¡€ç”Ÿå‘½ï¼š</span>
      <span id="reverse-base-life" class="result-value">0 ä¸ª</span>
    </div>
    <div class="result-row">
      <span class="result-label">åŸºç¡€æ”»å‡»ï¼š</span>
      <span id="reverse-base-attack" class="result-value">0 ä¸ª</span>
    </div>
    <div class="result-row">
      <span class="result-label">éªŒè¯æˆ˜åŠ›ï¼š</span>
      <span id="reverse-verify-power" class="result-value">0 ä¸ª</span>
    </div>
  </div>

  <!-- æ³¡æ¾¡è®¡ç®—ç»“æœ -->
  <div class="result-section hidden" id="bath-result-section">
    <h2>æ³¡æ¾¡ç»“æœ</h2>
    <div class="result-row">
      <span class="result-label">æ‰€éœ€æ—¶é—´ï¼š</span>
      <span id="bath-time-result" class="result-value">0 ç§’</span>
    </div>
    <div class="result-row">
      <span class="result-label">é¢„è®¡æ—¶é—´ï¼š</span>
      <span id="bath-estimate-time" class="result-value">2023/01/01 00:00</span>
    </div>
    <div class="result-row">
      <span class="result-label">éœ€è¦é­”ä¸¹ï¼š</span>
      <span id="bath-dan-count" class="dan-value">0 é¢—</span>
    </div>
  </div>

  <!-- éšè—çš„éŸ³ä¹æ§åˆ¶ -->
  <div class="music-controls">
    <button class="music-btn" onclick="toggleMusic()">â™ª</button>
  </div>
  
  
  
<!-- æ‰«é›·æ¸¸æˆå›¾æ ‡ -->
<div class="mine-icon" onclick="openMineGame()">ğŸ’£</div>

<!-- æ‰«é›·æ¸¸æˆç•Œé¢ -->
<div id="mine-game" class="mine-game">
  <h1 class="mine-title">æ‰«é›·æ¸¸æˆ</h1>
  
  <div class="difficulty-selector">
    <button class="difficulty-btn" onclick="startGame(8, 8, 10)">ç®€å•æ¨¡å¼</button>
    <button class="difficulty-btn" onclick="startGame(12, 12, 20)">ä¸­ç­‰æ¨¡å¼</button>
    <button class="difficulty-btn" onclick="startGame(16, 16, 40)">å›°éš¾æ¨¡å¼</button>
  </div>
  
  <div id="game-info-container" class="game-info-container hidden">
    <div class="game-info">
      <div class="mine-time-row">
        <div id="mine-count">å‰©ä½™ç‚¸å¼¹: 0</div>
        <div id="game-time">æ—¶é—´: 00:00:00</div>
      </div>
      <div class="flag-mode-row">
        <button id="flag-mode-btn" class="flag-mode-btn" onclick="toggleFlagMode()">æ’æ——æ¨¡å¼(å…³)</button>
      </div>
    </div>
    
    <div id="mine-board" class="mine-board"></div>
    
    <div class="game-controls">
      <button class="control-btn" onclick="restartGame()">é‡æ–°å¼€å§‹</button>
      <button class="control-btn exit-btn" onclick="exitGame()">é€€å‡ºæ¸¸æˆ</button>
    </div>
  </div>
</div>

    
 
</div>
</body>
  <script>
  


// å¯é€‰ï¼šæ›´ç²¾ç¡®çš„æ»‘åŠ¨æ£€æµ‹ï¼ˆä½†ä¸åŒ…æ‹¬ç®€å•çš„ä¸Šä¸‹å·¦å³æ»‘åŠ¨ï¼‰
let touchStartTime = 0;
let touchStartX = 0;
let touchStartY = 0;
  
   // æ‰«é›·æ¸¸æˆå˜é‡
    let mineBoard = [];
    let rows = 0;
    let cols = 0;
    let mineCount = 0;
    let flaggedCount = 0;
    let revealedCount = 0;
    let gameOver = false;
    let gameStartTime = 0;
    let timerInterval = null;
    let flagMode = false;
     
     
  //æå‡æ•°å€¼çš„åŒæ­¥å‡½æ•°
 function syncBoostValues(tabType, inputType, value) {
    // å…è®¸ç©ºå€¼åŒæ­¥
    if (value === '') {
        if (tabType === 'power') {
            if (inputType === 'life') {
                document.getElementById('attack-boost').value = '';
            } else if (inputType === 'attack') {
                document.getElementById('life-boost').value = '';
            }
        } else if (tabType === 'base') {
            if (inputType === 'life') {
                document.getElementById('reverse-attack-boost').value = '';
            } else if (inputType === 'attack') {
                document.getElementById('reverse-life-boost').value = '';
            }
        }
        return;
    }
    
    const numericValue = parseFloat(value);
    if (isNaN(numericValue)) return;
    
    if (tabType === 'power') {
        if (inputType === 'life') {
            document.getElementById('attack-boost').value = value;
        } else if (inputType === 'attack') {
            document.getElementById('life-boost').value = value;
        }
    } else if (tabType === 'base') {
        if (inputType === 'life') {
            document.getElementById('reverse-attack-boost').value = value;
        } else if (inputType === 'attack') {
            document.getElementById('reverse-life-boost').value = value;
        }
    }
}


  
  
function copyQQGroup() {
    const text = "371408377"; // è¦å¤åˆ¶çš„QQç¾¤å·
    
    // åˆ›å»ºä¸´æ—¶è¾“å…¥æ¡†
    const input = document.createElement('textarea');
    input.value = text;
    input.style.position = 'fixed';
    input.style.opacity = '0';
    document.body.appendChild(input);
    
    // é€‰ä¸­æ–‡æœ¬
    input.select();
    input.setSelectionRange(0, 99999); // å¯¹äºç§»åŠ¨è®¾å¤‡
    
    try {
        // å°è¯•ä½¿ç”¨ç°ä»£API
        const successful = document.execCommand('copy');
        document.body.removeChild(input);
        
        if (successful) {
            // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º
            showCopySuccess();
        } else {
            alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ï¼š' + text);
        }
    } catch (err) {
        document.body.removeChild(input);
        // å¤‡ç”¨æ–¹æ¡ˆï¼šæç¤ºç”¨æˆ·æ‰‹åŠ¨å¤åˆ¶
        alert('è¯·æ‰‹åŠ¨å¤åˆ¶QQç¾¤å·ï¼š' + text);
    }
}

// æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º
function showCopySuccess() {
    // åˆ›å»ºæç¤ºå…ƒç´ 
    const toast = document.createElement('div');
    toast.textContent = 'âœ“ å·²å¤åˆ¶åˆ°å‰ªè´´æ¿';
    toast.style.position = 'fixed';
    toast.style.bottom = '50px';
    toast.style.left = '50%';
    toast.style.transform = 'translateX(-50%)';
    toast.style.backgroundColor = 'rgba(0,0,0,0.7)';
    toast.style.color = 'white';
    toast.style.padding = '10px 20px';
    toast.style.borderRadius = '5px';
    toast.style.zIndex = '1000';
    toast.style.fontSize = '14px';
    
    document.body.appendChild(toast);
    
    // 2ç§’åè‡ªåŠ¨æ¶ˆå¤±
    setTimeout(() => {
        document.body.removeChild(toast);
    }, 2000);
}

      // éŸ³ä¹æ’­æ”¾åŠŸèƒ½ - å¢å¼ºç‰ˆ
    const musicLibrary = [
      {
        name: "ä¿®ä»™ä¹‹è·¯",
        url: "https://music.163.com/song/media/outer/url?id=1452131330.mp3"
      },
      {
        name: "ä»™å¢ƒæ¼«æ¸¸", 
        url: "https://music.163.com/song/media/outer/url?id=2126022114.mp3"
      },
      {
        name: "ä¿®çœŸä¹‹å¢ƒ",
        url: "https://music.163.com/song/media/outer/url?id=27969765.mp3"
      }
    ];

    let currentAudio = null;
    let isMusicPlaying = false;
    let currentMusicIndex = -1;
    let songQueue = []; // æ­Œæ›²æ’­æ”¾é˜Ÿåˆ—
    let hasUserInteracted = false;
    let isFirstInteraction = true; // é¦–æ¬¡äº¤äº’æ ‡è®°
    let isAutoCycleEnabled = false; // è‡ªåŠ¨å¾ªç¯æ ‡å¿—




function playRandomMusic() {
    if (!hasUserInteracted) {
        hasUserInteracted = true;
    }
    
    // å¦‚æœæ˜¯é¦–æ¬¡äº¤äº’ï¼Œç«‹å³æ’­æ”¾éŸ³ä¹
    if (isFirstInteraction) {
        isFirstInteraction = false;
        isAutoCycleEnabled = true; // å¯ç”¨è‡ªåŠ¨å¾ªç¯
        playNextSongImmediately();
        return;
    }
    
    // éé¦–æ¬¡äº¤äº’ï¼šå°†æ­Œæ›²åŠ å…¥é˜Ÿåˆ—
    addSongToQueue();
}

// ç«‹å³æ’­æ”¾ä¸‹ä¸€é¦–æ­Œæ›²
function playNextSongImmediately() {
    if (isMusicPlaying && currentAudio) {
        // å¦‚æœæ­£åœ¨æ’­æ”¾ï¼Œå…ˆåœæ­¢å½“å‰æ­Œæ›²
        currentAudio.pause();
        isMusicPlaying = false;
    }
    
    const nextSongIndex = getRandomSongIndex();
    if (nextSongIndex !== -1) {
        playSong(nextSongIndex);
    }
}

// å°†æ­Œæ›²æ·»åŠ åˆ°æ’­æ”¾é˜Ÿåˆ—
function addSongToQueue() {
    const nextSongIndex = getRandomSongIndex();
    if (nextSongIndex !== -1) {
        // æ£€æŸ¥é˜Ÿåˆ—ä¸­æ˜¯å¦å·²å­˜åœ¨è¯¥æ­Œæ›²
        if (!songQueue.includes(nextSongIndex)) {
            songQueue.push(nextSongIndex);
            console.log('æ­Œæ›²å·²åŠ å…¥é˜Ÿåˆ—ï¼Œå½“å‰é˜Ÿåˆ—é•¿åº¦:', songQueue.length);
        }
        
        // å¦‚æœæ²¡æœ‰æ­£åœ¨æ’­æ”¾çš„éŸ³ä¹ï¼Œç«‹å³å¼€å§‹æ’­æ”¾
        if (!isMusicPlaying && songQueue.length > 0) {
            playNextQueuedSong();
        }
    }
}

// æ’­æ”¾é˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€é¦–æ­Œæ›²
function playNextQueuedSong() {
    if (songQueue.length > 0) {
        const nextSongIndex = songQueue.shift();
        playSong(nextSongIndex);
    } else if (isAutoCycleEnabled) {
        // é˜Ÿåˆ—ä¸ºç©ºä¸”è‡ªåŠ¨å¾ªç¯å¯ç”¨æ—¶ï¼Œéšæœºæ’­æ”¾éå½“å‰æ­Œæ›²
        startAutoPlayCycle();
    }
}

// å¼€å§‹è‡ªåŠ¨å¾ªç¯æ’­æ”¾
function startAutoPlayCycle() {
    if (!hasUserInteracted) return;
    
    const nextSongIndex = getRandomSongIndex();
    if (nextSongIndex !== -1) {
        console.log('è‡ªåŠ¨å¾ªç¯æ’­æ”¾ä¸‹ä¸€é¦–æ­Œæ›²');
        playSong(nextSongIndex);
    } else if (musicLibrary.length > 0) {
        // å¦‚æœæ²¡æœ‰å¯ç”¨æ­Œæ›²ï¼Œæ’­æ”¾ç¬¬ä¸€é¦–
        playSong(0);
    }
}

// è·å–éšæœºæ­Œæ›²ç´¢å¼•ï¼ˆæ’é™¤å½“å‰æ’­æ”¾çš„æ­Œæ›²ï¼‰
function getRandomSongIndex() {
    if (musicLibrary.length === 0) return -1;
    
    if (musicLibrary.length === 1) {
        return 0; // å¦‚æœåªæœ‰ä¸€é¦–æ­Œï¼Œåªèƒ½æ’­æ”¾å®ƒ
    }
    
    let availableIndices = [];
    if (currentMusicIndex === -1) {
        // è¿˜æ²¡æœ‰æ’­æ”¾è¿‡æ­Œæ›²ï¼Œæ‰€æœ‰æ­Œæ›²éƒ½å¯é€‰
        availableIndices = musicLibrary.map((_, index) => index);
    } else {
        // æ’é™¤å½“å‰æ­£åœ¨æ’­æ”¾çš„æ­Œæ›²
        availableIndices = musicLibrary.map((_, index) => index)
                                     .filter(index => index !== currentMusicIndex);
    }
    
    if (availableIndices.length === 0) {
        // å¦‚æœæ²¡æœ‰å¯ç”¨æ­Œæ›²ï¼Œè¿”å›å½“å‰æ­Œæ›²ï¼ˆå¾ªç¯æ’­æ”¾ï¼‰
        return currentMusicIndex;
    }
    
    const randomIndex = Math.floor(Math.random() * availableIndices.length);
    return availableIndices[randomIndex];
}

// æ’­æ”¾æŒ‡å®šç´¢å¼•çš„æ­Œæ›²
function playSong(songIndex) {
    try {
        if (currentAudio) {
            currentAudio.pause();
            currentAudio = null;
        }
        
        if (songIndex < 0 || songIndex >= musicLibrary.length) {
            console.error('æ— æ•ˆçš„æ­Œæ›²ç´¢å¼•:', songIndex);
            // æ’­æ”¾å¤±è´¥æ—¶å°è¯•æ’­æ”¾ä¸‹ä¸€ä¸ª
            setTimeout(() => playNextQueuedSong(), 1000);
            return;
        }
        
        const music = musicLibrary[songIndex];
        currentMusicIndex = songIndex;
        
        console.log('æ’­æ”¾éŸ³ä¹:', music.name);
        
        currentAudio = new Audio(music.url);
        currentAudio.volume = 0.3;
        currentAudio.preload = 'auto';
        
        // éŸ³ä¹æ’­æ”¾æˆåŠŸ
        currentAudio.addEventListener('canplaythrough', function() {
            const playPromise = currentAudio.play();
            
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    isMusicPlaying = true;
                    console.log('éŸ³ä¹æ’­æ”¾æˆåŠŸ:', music.name);
                }).catch(error => {
                    console.log('è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢:', error);
                    isMusicPlaying = false;
                    // æ’­æ”¾å¤±è´¥æ—¶å°è¯•æ’­æ”¾ä¸‹ä¸€ä¸ª
                    setTimeout(() => playNextQueuedSong(), 1000);
                });
            }
        });
        
        // éŸ³ä¹åŠ è½½å¤±è´¥
        currentAudio.addEventListener('error', function(e) {
            console.error('éŸ³ä¹åŠ è½½å¤±è´¥:', e);
            isMusicPlaying = false;
            // åŠ è½½å¤±è´¥æ—¶å°è¯•æ’­æ”¾ä¸‹ä¸€ä¸ª
            setTimeout(() => playNextQueuedSong(), 1000);
        });
        
        // éŸ³ä¹æ’­æ”¾ç»“æŸ
        currentAudio.addEventListener('ended', function() {
            console.log('éŸ³ä¹æ’­æ”¾ç»“æŸ:', music.name);
            isMusicPlaying = false;
            // æ’­æ”¾ç»“æŸåè‡ªåŠ¨æ’­æ”¾ä¸‹ä¸€ä¸ªï¼ˆé˜Ÿåˆ—æˆ–å¾ªç¯ï¼‰
            playNextQueuedSong();
        });
        
    } catch (error) {
        console.error('æ’­æ”¾éŸ³ä¹å‡ºé”™:', error);
        isMusicPlaying = false;
        setTimeout(() => playNextQueuedSong(), 1000);
    }
}

function handleUserInteraction() {
    playRandomMusic();
}



    

    // æ ‡ç­¾é¡µåˆ‡æ¢å˜é‡
    let currentTabIndex = 0;
    const tabOrder = ['power', 'base', 'bath'];

    // è§¦æ‘¸æ»‘åŠ¨ç›¸å…³å˜é‡
    let startX = 0;
    let currentX = 0;
    let isSwiping = false;
    const swipeThreshold = 80; // æ»‘åŠ¨é˜ˆå€¼

    // åˆå§‹åŒ–è§¦æ‘¸äº‹ä»¶
    function initSwipe() {
      const container = document.getElementById('content-container');
      
      container.addEventListener('touchstart', function(e) {
        startX = e.touches[0].clientX;
        currentX = startX;
        isSwiping = true;
        handleUserInteraction();
      });
      
      container.addEventListener('touchmove', function(e) {
        if (!isSwiping) return;
        currentX = e.touches[0].clientX;
        
        // é˜»æ­¢é»˜è®¤è¡Œä¸ºä»¥é¿å…é¡µé¢æ»šåŠ¨
        if (Math.abs(currentX - startX) > 10) {
          e.preventDefault();
          handleUserInteraction();
        }
      });
      
      container.addEventListener('touchend', function(e) {
        if (!isSwiping) return;
        
        const deltaX = currentX - startX;
        
        if (Math.abs(deltaX) > swipeThreshold) {
          if (deltaX > 0) {
            // å‘å³æ»‘åŠ¨ï¼Œåˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªæ ‡ç­¾
            switchTabBySwipe(-1);
          } else {
            // å‘å·¦æ»‘åŠ¨ï¼Œåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªæ ‡ç­¾
            switchTabBySwipe(1);
          }
        }
        
        isSwiping = false;
        startX = 0;
        currentX = 0;
      });
      
      // é¼ æ ‡äº‹ä»¶æ”¯æŒï¼ˆç”¨äºæ¡Œé¢ç«¯æµ‹è¯•ï¼‰
      container.addEventListener('mousedown', function(e) {
        startX = e.clientX;
        currentX = startX;
        isSwiping = true;
        handleUserInteraction();
      });
      
      container.addEventListener('mousemove', function(e) {
        if (!isSwiping) return;
        currentX = e.clientX;
      });
      
      container.addEventListener('mouseup', function(e) {
        if (!isSwiping) return;
        
        const deltaX = currentX - startX;
        
        if (Math.abs(deltaX) > swipeThreshold) {
          if (deltaX > 0) {
            switchTabBySwipe(-1);
          } else {
            switchTabBySwipe(1);
          }
        }
        
        isSwiping = false;
        startX = 0;
        currentX = 0;
      });
      
      // ç¡®ä¿é¼ æ ‡ç¦»å¼€æ—¶é‡ç½®çŠ¶æ€
      container.addEventListener('mouseleave', function(e) {
        isSwiping = false;
        startX = 0;
        currentX = 0;
      });
    }

    // é€šè¿‡æ»‘åŠ¨åˆ‡æ¢æ ‡ç­¾é¡µ
    function switchTabBySwipe(direction) {
      let newTabIndex = currentTabIndex + direction;
      
// å¾ªç¯é€»è¾‘
if (newTabIndex < 0) {
    newTabIndex = tabOrder.length - 1; // ä»ç¬¬ä¸€ä¸ªè·³åˆ°æœ€åä¸€ä¸ª
} else if (newTabIndex >= tabOrder.length) {
    newTabIndex = 0; // ä»æœ€åä¸€ä¸ªè·³åˆ°ç¬¬ä¸€ä¸ª
}

      
      // å¦‚æœæ ‡ç­¾é¡µæœ‰å˜åŒ–ï¼Œåˆ™åˆ‡æ¢
      if (newTabIndex !== currentTabIndex) {
        switchTab(tabOrder[newTabIndex], newTabIndex);
      }
    }

    // æ ‡ç­¾é¡µåˆ‡æ¢å‡½æ•°ï¼ˆå¸¦æ»‘åŠ¨åŠ¨ç”»ï¼‰
    function switchTab(tabName, tabIndex) {
      const tabs = document.querySelectorAll('.tab');
      const contents = document.querySelectorAll('.tab-content');
      const oldTabIndex = currentTabIndex;
      currentTabIndex = tabIndex;

      // æ›´æ–°æ ‡ç­¾çŠ¶æ€
      tabs.forEach(tab => tab.classList.remove('active'));
      tabs[tabIndex].classList.add('active');

      // æ»‘åŠ¨åŠ¨ç”»
      contents.forEach(content => {
        if (content.classList.contains('active')) {
          if (tabIndex > oldTabIndex) {
            content.classList.add('slide-left');
          } else {
            content.classList.add('slide-right');
          }
          content.classList.remove('active');
        }
      });

      setTimeout(() => {
        contents.forEach(content => {
          content.classList.remove('slide-left', 'slide-right');
          if (content.id === tabName + '-tab') {
            content.classList.add('active');
          }
        });
      }, 50);

      // éšè—æ‰€æœ‰ç»“æœ
      document.getElementById('power-result-section').classList.add('hidden');
      document.getElementById('base-result-section').classList.add('hidden');
      document.getElementById('bath-result-section').classList.add('hidden');
    }

    // å•ä½æ ¼å¼åŒ–å‡½æ•°
    function formatNumberWithUnit(num) {
      const units = [
        { name: "ä¸ª", value: 1 },
        { name: "ä¸‡", value: 10000 },
        { name: "äº¿", value: 100000000 },
        { name: "å…†", value: 1000000000000 },
        { name: "äº¬", value: 10000000000000000 },
        { name: "å“", value: 100000000000000000000 },
        { name: "ç§­", value: 1000000000000000000000000 },
        { name: "ç©°", value: 10000000000000000000000000000 },
        { name: "æ²Ÿ", value: 100000000000000000000000000000000 },
        { name: "æ¶§", value: 1000000000000000000000000000000000000 },
        { name: "æ­£", value: 10000000000000000000000000000000000000000 },
        { name: "è½½", value: 100000000000000000000000000000000000000000000 },
        { name: "æ", value: 1000000000000000000000000000000000000000000000000 },
        { name: "æ’æ²³æ²™", value: 10000000000000000000000000000000000000000000000000000 },
        { name: "é˜¿åƒ§ç¥‡", value: 100000000000000000000000000000000000000000000000000000000 },
        { name: "é‚£ç”±ä»–", value: 1000000000000000000000000000000000000000000000000000000000000 },
        { name: "ä¸å¯æ€è®®", value: 10000000000000000000000000000000000000000000000000000000000000000 },
        { name: "æ— é‡", value: 100000000000000000000000000000000000000000000000000000000000000000000 },
        { name: "å¤§æ•°", value: 1000000000000000000000000000000000000000000000000000000000000000000000000 },
        { name: "æ— æ•Œ", value: 10000000000000000000000000000000000000000000000000000000000000000000000000000 }
      ];
      
      if (num === 0) return "0 ä¸ª";
      
      for (let i = units.length - 1; i >= 0; i--) {
        if (num >= units[i].value) {
          return (num / units[i].value).toFixed(2) + " " + units[i].name;
        }
      }
      return num.toFixed(2) + " ä¸ª";
    }

    // æˆ˜åŠ›è®¡ç®—å‡½æ•°
    function calculatePower() {
      const baseLife = parseFloat(document.getElementById('base-life').value) || 0;
      const baseLifeUnit = parseFloat(document.getElementById('base-life-unit').value) || 1;
      const baseAttack = parseFloat(document.getElementById('base-attack').value) || 0;
      const baseAttackUnit = parseFloat(document.getElementById('base-attack-unit').value) || 1;
      
      const lifeBonus = parseFloat(document.getElementById('life-bonus').value) || 0;
      const lifeBoost = parseFloat(document.getElementById('life-boost').value) || 0;
      const lifeAmplify = parseFloat(document.getElementById('life-amplify').value) || 0;
      
      const attackBonus = parseFloat(document.getElementById('attack-bonus').value) || 0;
      const attackBoost = parseFloat(document.getElementById('attack-boost').value) || 0;
      const attackAmplify = parseFloat(document.getElementById('attack-amplify').value) || 0;
      
      const lifeMultiplier = (1 + lifeBonus/100) * (1 + lifeBoost/100) * (1 + lifeAmplify/100);
      const attackMultiplier = (1 + attackBonus/100) * (1 + attackBoost/100) * (1 + attackAmplify/100);
      
      const finalLife = baseLife * baseLifeUnit * lifeMultiplier;
      const finalAttack = baseAttack * baseAttackUnit * attackMultiplier;
      const totalPower = finalLife + 5 * finalAttack;
      
      document.getElementById('final-life').textContent = formatNumberWithUnit(finalLife);
      document.getElementById('final-attack').textContent = formatNumberWithUnit(finalAttack);
      document.getElementById('total-power').textContent = formatNumberWithUnit(totalPower);
      
      document.getElementById('power-result-section').classList.remove('hidden');
      document.getElementById('base-result-section').classList.add('hidden');
      document.getElementById('bath-result-section').classList.add('hidden');
    }

    // åŸºç¡€åæ¨å‡½æ•°
    function reverseCalculate() {
      const targetPower = parseFloat(document.getElementById('target-power').value) || 0;
      const powerUnit = parseFloat(document.getElementById('power-unit').value) || 1;
      const totalPower = targetPower * powerUnit;
      
      const lifeBonus = parseFloat(document.getElementById('reverse-life-bonus').value) || 0;
      const lifeBoost = parseFloat(document.getElementById('reverse-life-boost').value) || 0;
      const lifeAmplify = parseFloat(document.getElementById('reverse-life-amplify').value) || 0;
      
      const attackBonus = parseFloat(document.getElementById('reverse-attack-bonus').value) || 0;
      const attackBoost = parseFloat(document.getElementById('reverse-attack-boost').value) || 0;
      const attackAmplify = parseFloat(document.getElementById('reverse-attack-amplify').value) || 0;
      
      const lifeMultiplier = (1 + lifeBonus/100) * (1 + lifeBoost/100) * (1 + lifeAmplify/100);
      const attackMultiplier = (1 + attackBonus/100) * (1 + attackBoost/100) * (1 + attackAmplify/100);
      
      const baseAttack = totalPower / (5 * (lifeMultiplier + attackMultiplier));
      const baseLife = 5 * baseAttack;
      
      const verifyLife = baseLife * lifeMultiplier;
      const verifyAttack = baseAttack * attackMultiplier;
      const verifyPower = verifyLife + 5 * verifyAttack;
      
      document.getElementById('reverse-base-life').textContent = formatNumberWithUnit(baseLife);
      document.getElementById('reverse-base-attack').textContent = formatNumberWithUnit(baseAttack);
      document.getElementById('reverse-verify-power').textContent = formatNumberWithUnit(verifyPower);
      
      document.getElementById('base-result-section').classList.remove('hidden');
      document.getElementById('power-result-section').classList.add('hidden');
      document.getElementById('bath-result-section').classList.add('hidden');
    }

    // æ³¡æ¾¡è®¡ç®—å‡½æ•°
    function calculateBath() {
      const initialPower = parseFloat(document.getElementById('initial-power-bath').value) || 0;
      const initialUnit = parseFloat(document.getElementById('initial-power-unit-bath').value) || 1;
      const targetPower = parseFloat(document.getElementById('target-power-bath').value) || 0;
      const targetUnit = parseFloat(document.getElementById('target-power-unit-bath').value) || 1;
      const growthRate = parseFloat(document.getElementById('growth-rate').value) || 0.01;
      
      const initial = initialPower * initialUnit;
      const target = targetPower * targetUnit;
      
      // æ–°å¢éªŒè¯é€»è¾‘
      if (initial <= 0) {
        alert("åˆå§‹æˆ˜åŠ›å¿…é¡»å¤§äº0");
        return;
      }
      
      if (target <= initial) {
        alert("ç›®æ ‡æˆ˜åŠ›å¿…é¡»å¤§äºåˆå§‹æˆ˜åŠ›");
        return;
      }
      
      const growthFactor = 1 + growthRate / 100;
      let current = initial;
      let timeCount = 0;
      
      while (current < target) {
        current *= growthFactor;
        timeCount++;
      }
      
      const totalSeconds = timeCount * 5;
      const days = Math.floor(totalSeconds / 86400);
      const hours = Math.floor((totalSeconds % 86400) / 3600);
      const minutes = Math.floor((totalSeconds % 3600) / 60);
      const seconds = totalSeconds % 60;
      
      let timeString = "";
      if (days > 0) timeString += `${days}å¤©`;
      if (hours > 0) timeString += `${hours}å°æ—¶`;
      if (minutes > 0) timeString += `${minutes}åˆ†é’Ÿ`;
      timeString += `${seconds}ç§’`;
      
      const now = new Date();
      const completionDate = new Date(now.getTime() + totalSeconds * 1000);
      const formattedDate = completionDate.getFullYear() + '/' + 
                           String(completionDate.getMonth() + 1).padStart(2, '0') + '/' + 
                           String(completionDate.getDate()).padStart(2, '0') + ' ' + 
                           String(completionDate.getHours()).padStart(2, '0') + ':' + 
                           String(completionDate.getMinutes()).padStart(2, '0');
      
      const danFactor = 1.0001;
      current = initial;
      let danCount = 0;
      
      while (current < target) {
        current *= danFactor;
        danCount++;
      }
      
      document.getElementById('bath-time-result').textContent = timeString;
      document.getElementById('bath-estimate-time').textContent = formattedDate;
      document.getElementById('bath-dan-count').textContent = danCount.toLocaleString() + "é¢—";
      
      document.getElementById('bath-result-section').classList.remove('hidden');
      document.getElementById('power-result-section').classList.add('hidden');
      document.getElementById('base-result-section').classList.add('hidden');
    }

    // åˆå§‹åŒ–æ»‘åŠ¨åŠŸèƒ½
    document.addEventListener('DOMContentLoaded', function() {
      initSwipe();
    });
    
    
    

function handleUserInteraction() {
    if (!hasUserInteracted && !isMusicPlaying) {
        hasUserInteracted = true;
        playRandomMusic();
    }
}

// ç›‘å¬ä¸»è¦ç”¨æˆ·äº¤äº’
document.addEventListener('click', handleUserInteraction);
document.addEventListener('touchstart', handleUserInteraction);
document.addEventListener('keydown', handleUserInteraction);
document.addEventListener('mousedown', handleUserInteraction);
document.addEventListener('input', handleUserInteraction);
document.addEventListener('change', handleUserInteraction);

// ç‰¹åˆ«ä¸ºæ‰€æœ‰å¯äº¤äº’å…ƒç´ æ·»åŠ ç›‘å¬
document.querySelectorAll('button, .tab, input, select, label').forEach(element => {
    element.addEventListener('click', handleUserInteraction);
    element.addEventListener('touchstart', handleUserInteraction);
    element.addEventListener('focus', handleUserInteraction);
});


contentContainer.addEventListener('touchstart', function(e) {
    touchStartTime = Date.now();
    touchStartX = e.touches[0].clientX;
    touchStartY = e.touches[0].clientY;
    handleUserInteraction();
});

contentContainer.addEventListener('touchmove', function(e) {
    const touchX = e.touches[0].clientX;
    const touchY = e.touches[0].clientY;
    const deltaX = Math.abs(touchX - touchStartX);
    const deltaY = Math.abs(touchY - touchStartY);
    const elapsedTime = Date.now() - touchStartTime;
    
    // åªæœ‰åœ¨æ»‘åŠ¨è·ç¦»è¾ƒå¤§ä¸”æ—¶é—´è¾ƒçŸ­æ—¶æ‰è§¦å‘ï¼ˆé¿å…è¯¯è§¦ï¼‰
    if ((deltaX > 20 || deltaY > 20) && elapsedTime < 500) {
        handleUserInteraction();
    }
});


// ç›‘å¬é”®ç›˜è¾“å…¥
document.addEventListener('keydown', handleUserInteraction);

// ç›‘å¬æ‰€æœ‰è¡¨å•äº¤äº’
document.querySelectorAll('input, select, textarea').forEach(element => {
    element.addEventListener('input', handleUserInteraction);
    element.addEventListener('change', handleUserInteraction);
    element.addEventListener('focus', handleUserInteraction);
});

// ç›‘å¬æ ‡ç­¾é¡µåˆ‡æ¢
document.querySelectorAll('.tab').forEach(tab => {
    tab.addEventListener('click', handleUserInteraction);
});

// ç›‘å¬æŒ‰é’®ç‚¹å‡»
document.querySelectorAll('button').forEach(button => {
    button.addEventListener('click', handleUserInteraction);
});

// ç›‘å¬æ»‘åŠ¨å†…å®¹åŒºåŸŸ
const contentContainer = document.getElementById('content-container');
if (contentContainer) {
    contentContainer.addEventListener('touchstart', handleUserInteraction);
    contentContainer.addEventListener('mousedown', handleUserInteraction);
    contentContainer.addEventListener('click', handleUserInteraction);
}

// ç›‘å¬æ‰€æœ‰è¾“å…¥åŒºåŸŸ
const inputSections = document.querySelectorAll('.input-section');
inputSections.forEach(section => {
    section.addEventListener('touchstart', handleUserInteraction);
    section.addEventListener('mousedown', handleUserInteraction);
    section.addEventListener('click', handleUserInteraction);
});

// ç›‘å¬æ‰€æœ‰ç»“æœåŒºåŸŸ
const resultSections = document.querySelectorAll('.result-section');
resultSections.forEach(section => {
    section.addEventListener('touchstart', handleUserInteraction);
    section.addEventListener('mousedown', handleUserInteraction);
    section.addEventListener('click', handleUserInteraction);
});

// ç›‘å¬æ‰€æœ‰åŠ æˆåŒºåŸŸ
const bonusContainers = document.querySelectorAll('.bonus-container');
bonusContainers.forEach(container => {
    container.addEventListener('touchstart', handleUserInteraction);
    container.addEventListener('mousedown', handleUserInteraction);
    container.addEventListener('click', handleUserInteraction);
});

// ç›‘å¬æ‰€æœ‰è¾“å…¥æ¡†ç»„
const inputGroups = document.querySelectorAll('.input-group');
inputGroups.forEach(group => {
    group.addEventListener('touchstart', handleUserInteraction);
    group.addEventListener('mousedown', handleUserInteraction);
    group.addEventListener('click', handleUserInteraction);
});

// ç›‘å¬æ‰€æœ‰è¾“å…¥è¡Œ
const inputRows = document.querySelectorAll('.input-row');
inputRows.forEach(row => {
    row.addEventListener('touchstart', handleUserInteraction);
    row.addEventListener('mousedown', handleUserInteraction);
    row.addEventListener('click', handleUserInteraction);
});

// ç›‘å¬æ‰€æœ‰è®¡ç®—å‡½æ•°
if (typeof calculatePower === 'function') {
    const originalCalculatePower = calculatePower;
    window.calculatePower = function() {
        handleUserInteraction();
        return originalCalculatePower();
    };
}

if (typeof reverseCalculate === 'function') {
    const originalReverseCalculate = reverseCalculate;
    window.reverseCalculate = function() {
        handleUserInteraction();
        return originalReverseCalculate();
    };
}

if (typeof calculateBath === 'function') {
    const originalCalculateBath = calculateBath;
    window.calculateBath = function() {
        handleUserInteraction();
        return originalCalculateBath();
    };
}

console.log('éŸ³ä¹äº¤äº’ç›‘å¬å·²å¯ç”¨ - ç”¨æˆ·æ“ä½œå°†è§¦å‘éŸ³ä¹æ’­æ”¾ï¼ˆåŒ…å«å†…å®¹åŒºåŸŸæ»‘åŠ¨è§¦å‘ï¼‰');

 


// æ‰“å¼€æ‰«é›·æ¸¸æˆ
function openMineGame() {
  document.getElementById('mine-game').style.display = 'block';
  document.getElementById('game-info-container').classList.add('hidden');
}

// å¼€å§‹æ¸¸æˆ
function startGame(r, c, m) {
  rows = r;
  cols = c;
  mineCount = m;
  flaggedCount = 0;
  revealedCount = 0;
  gameOver = false;
  flagMode = false;
  
  document.getElementById('game-info-container').classList.remove('hidden');
  document.getElementById('flag-mode-btn').classList.remove('active');
  document.getElementById('flag-mode-btn').textContent = 'æ’æ——æ¨¡å¼(å…³)';
  
  if (timerInterval) clearInterval(timerInterval);
  gameStartTime = Date.now();
  timerInterval = setInterval(updateTimer, 1000);
  
  initializeBoard();
  updateMineCount();
  updateTimer();
}

// åˆå§‹åŒ–æ£‹ç›˜
function initializeBoard() {
  const boardElement = document.getElementById('mine-board');
  boardElement.style.setProperty('--cols', cols);
  
  boardElement.className = 'mine-board';
  if (rows === 8) boardElement.classList.add('easy');
  else if (rows === 12) boardElement.classList.add('medium');
  else boardElement.classList.add('hard');
  
  boardElement.innerHTML = '';
  
  // åˆ›å»ºäºŒç»´æ•°ç»„
  mineBoard = Array(rows).fill().map(() => Array(cols).fill(0));
  
  // æ”¾ç½®ç‚¸å¼¹
  let minesPlaced = 0;
  while (minesPlaced < mineCount) {
    const x = Math.floor(Math.random() * rows);
    const y = Math.floor(Math.random() * cols);
    
    if (mineBoard[x][y] !== -1) {
      mineBoard[x][y] = -1; // -1è¡¨ç¤ºç‚¸å¼¹
      minesPlaced++;
      
      // æ›´æ–°å‘¨å›´æ ¼å­çš„æ•°å­—
      for (let dx = -1; dx <= 1; dx++) {
        for (let dy = -1; dy <= 1; dy++) {
          const nx = x + dx;
          const ny = y + dy;
          
          if (nx >= 0 && nx < rows && ny >= 0 && ny < cols && mineBoard[nx][ny] !== -1) {
            mineBoard[nx][ny]++;
          }
        }
      }
    }
  }
  
  // åˆ›å»ºæ ¼å­å…ƒç´ 
  for (let i = 0; i < rows; i++) {
    for (let j = 0; j < cols; j++) {
      const cell = document.createElement('div');
      cell.className = 'mine-cell';
      cell.dataset.x = i;
      cell.dataset.y = j;
      
      // ä½¿ç”¨spanåŒ…è£¹å†…å®¹ç¡®ä¿ç¼©æ”¾
      const contentSpan = document.createElement('span');
      cell.appendChild(contentSpan);
      
      // ç‚¹å‡»äº‹ä»¶
      cell.addEventListener('click', function() {
        if (!gameOver) {
          if (flagMode) {
            flagCell(i, j);
          } else {
            revealCell(i, j);
          }
        }
      });
      
      // å³é”®äº‹ä»¶
      cell.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        if (!gameOver) flagCell(i, j);
      });
      
      // ç§»åŠ¨ç«¯é•¿æŒ‰äº‹ä»¶
      let pressTimer;
      cell.addEventListener('touchstart', function() {
        pressTimer = setTimeout(() => {
          if (!gameOver) flagCell(i, j);
        }, 500);
      });
      
      cell.addEventListener('touchend', function() {
        clearTimeout(pressTimer);
      });
      
      boardElement.appendChild(cell);
    }
  }
}

// åˆ‡æ¢æ’æ——æ¨¡å¼
function toggleFlagMode() {
  flagMode = !flagMode;
  const btn = document.getElementById('flag-mode-btn');
  if (flagMode) {
    btn.classList.add('active');
    btn.textContent = 'æ’æ——æ¨¡å¼(å¼€)';
  } else {
    btn.classList.remove('active');
    btn.textContent = 'æ’æ——æ¨¡å¼(å…³)';
  }
}

// æ­ç¤ºæ ¼å­
// æ­ç¤ºæ ¼å­
function revealCell(x, y) {
  const cell = document.querySelector(`.mine-cell[data-x="${x}"][data-y="${y}"]`);
  const contentSpan = cell.querySelector('span');
  
  if (cell.classList.contains('revealed') || cell.classList.contains('flagged')) {
    return;
  }
  
  cell.classList.add('revealed');
  revealedCount++;
  
  if (mineBoard[x][y] === -1) {
    // è¸©åˆ°ç‚¸å¼¹
    cell.classList.add('mine');
    contentSpan.innerHTML = '<span class="emoji">ğŸ’£</span>';
    gameOver = true;
    revealAllMines();
    clearInterval(timerInterval);
    setTimeout(() => alert('æ¸¸æˆç»“æŸï¼ä½ è¸©åˆ°äº†ç‚¸å¼¹ï¼'), 10);
  } else if (mineBoard[x][y] > 0) {
    // æ˜¾ç¤ºæ•°å­—ï¼ˆæ ¹æ®éš¾åº¦é™åˆ¶æœ€å¤§æ•°å­—ï¼‰
    let displayNumber = mineBoard[x][y];
    if (rows === 8) displayNumber = Math.min(displayNumber, 3); // ç®€å•æ¨¡å¼æœ€å¤§3
    else if (rows === 12) displayNumber = Math.min(displayNumber, 4); // ä¸­ç­‰æ¨¡å¼æœ€å¤§4
    else displayNumber = Math.min(displayNumber, 5); // å›°éš¾æ¨¡å¼æœ€å¤§5
    
    contentSpan.innerHTML = `<span class="number-${displayNumber}">${displayNumber}</span>`;
  } else {
    // ç©ºç™½æ ¼å­ï¼Œé€’å½’æ­ç¤ºå‘¨å›´
    for (let dx = -1; dx <= 1; dx++) {
      for (let dy = -1; dy <= 1; dy++) {
        const nx = x + dx;
        const ny = y + dy;
        
        if (nx >= 0 && nx < rows && ny >= 0 && ny < cols) {
          revealCell(nx, ny);
        }
      }
    }
  }
  
  // æ£€æŸ¥æ˜¯å¦èƒœåˆ©
  checkWinCondition();
}


// æ’æ——
function flagCell(x, y) {
  const cell = document.querySelector(`.mine-cell[data-x="${x}"][data-y="${y}"]`);
  const contentSpan = cell.querySelector('span');
  
  if (cell.classList.contains('revealed')) {
    return;
  }
  
  if (cell.classList.contains('flagged')) {
    cell.classList.remove('flagged');
    contentSpan.innerHTML = '';
    flaggedCount--;
  } else {
    cell.classList.add('flagged');
    contentSpan.innerHTML = '<span class="emoji">ğŸš©</span>';
    flaggedCount++;
  }
  
  updateMineCount();
  
  // æ£€æŸ¥æ˜¯å¦æ’æ——æ•°é‡ç­‰äºç‚¸å¼¹æ•°é‡
  if (flaggedCount === mineCount) {
    checkFlagAccuracy();
  }
}

// æ£€æŸ¥æ——å¸œä½ç½®å‡†ç¡®æ€§
function checkFlagAccuracy() {
  let correctFlags = 0;
  
  // éå†æ‰€æœ‰æ ¼å­æ£€æŸ¥æ’æ——æ˜¯å¦æ­£ç¡®
  for (let i = 0; i < rows; i++) {
    for (let j = 0; j < cols; j++) {
      const cell = document.querySelector(`.mine-cell[data-x="${i}"][data-y="${j}"]`);
      if (cell.classList.contains('flagged') && mineBoard[i][j] === -1) {
        correctFlags++;
      }
    }
  }
  
  // å¦‚æœæ’æ——æ•°é‡ç­‰äºç‚¸å¼¹æ•°é‡ä½†ä½ç½®ä¸å¯¹
  if (correctFlags !== mineCount) {
    gameOver = true;
    clearInterval(timerInterval);
    revealAllMines();
    setTimeout(() => alert('æ¸¸æˆç»“æŸï¼ä½ çš„æ’æ——ä½ç½®æœ‰è¯¯ï¼'), 10);
  } else {
    // å¦‚æœå…¨éƒ¨æ­£ç¡®åˆ™èƒœåˆ©
    gameOver = true;
    clearInterval(timerInterval);
    revealAllCellsExceptFlags(); // æ–°å¢ï¼šèƒœåˆ©æ—¶æ­å¼€æ‰€æœ‰éæ——æ ¼å­
    setTimeout(() => alert('æ­å–œä½ èµ¢äº†ï¼æ‰€æœ‰ç‚¸å¼¹éƒ½è¢«æ­£ç¡®æ ‡è®°ï¼'), 10);
  }
}

// æ£€æŸ¥èƒœåˆ©æ¡ä»¶
function checkWinCondition() {
  // å¸¸è§„èƒœåˆ©æ¡ä»¶ï¼šæ­ç¤ºæ‰€æœ‰éç‚¸å¼¹æ ¼å­
  if (revealedCount === rows * cols - mineCount && !gameOver) {
    gameOver = true;
    clearInterval(timerInterval);
    revealAllCellsExceptFlags(); // æ–°å¢ï¼šèƒœåˆ©æ—¶æ­å¼€æ‰€æœ‰éæ——æ ¼å­
    setTimeout(() => alert('æ­å–œä½ èµ¢äº†ï¼'), 10);
  }
  
  // é¢å¤–æ£€æŸ¥ï¼šå¦‚æœæ‰€æœ‰ç‚¸å¼¹éƒ½è¢«æ­£ç¡®æ ‡è®°ä¹Ÿç®—èƒœåˆ©
  if (!gameOver) {
    let allFlagsCorrect = true;
    for (let i = 0; i < rows; i++) {
      for (let j = 0; j < cols; j++) {
        const cell = document.querySelector(`.mine-cell[data-x="${i}"][data-y="${j}"]`);
        if (mineBoard[i][j] === -1 && !cell.classList.contains('flagged')) {
          allFlagsCorrect = false;
          break;
        }
      }
      if (!allFlagsCorrect) break;
    }
    
    if (allFlagsCorrect) {
      gameOver = true;
      clearInterval(timerInterval);
      revealAllCellsExceptFlags(); // æ–°å¢ï¼šèƒœåˆ©æ—¶æ­å¼€æ‰€æœ‰éæ——æ ¼å­
      setTimeout(() => alert('æ­å–œä½ èµ¢äº†ï¼æ‰€æœ‰ç‚¸å¼¹éƒ½è¢«æ­£ç¡®æ ‡è®°ï¼'), 10);
    }
  }
}

// æ–°å¢ï¼šèƒœåˆ©æ—¶æ­å¼€æ‰€æœ‰éæ——æ ¼å­
function revealAllCellsExceptFlags() {
  for (let i = 0; i < rows; i++) {
    for (let j = 0; j < cols; j++) {
      const cell = document.querySelector(`.mine-cell[data-x="${i}"][data-y="${j}"]`);
      const contentSpan = cell.querySelector('span');
      
      if (!cell.classList.contains('flagged') && !cell.classList.contains('revealed')) {
        cell.classList.add('revealed');
        
        if (mineBoard[i][j] === -1) {
          cell.classList.add('mine');
          contentSpan.innerHTML = '<span class="emoji">ğŸ’£</span>';
        } else if (mineBoard[i][j] > 0) {
          contentSpan.textContent = mineBoard[i][j];
        }
      }
    }
  }
}

// æ­ç¤ºæ‰€æœ‰ç‚¸å¼¹
function revealAllMines() {
  for (let i = 0; i < rows; i++) {
    for (let j = 0; j < cols; j++) {
      if (mineBoard[i][j] === -1) {
        const cell = document.querySelector(`.mine-cell[data-x="${i}"][data-y="${j}"]`);
        if (!cell.classList.contains('flagged')) {
          cell.classList.add('mine');
          cell.querySelector('span').innerHTML = '<span class="emoji">ğŸ’£</span>';
        }
      }
    }
  }
}

// æ›´æ–°ç‚¸å¼¹è®¡æ•°
function updateMineCount() {
  document.getElementById('mine-count').textContent = `å‰©ä½™ç‚¸å¼¹: ${mineCount - flaggedCount}`;
}

// æ›´æ–°è®¡æ—¶å™¨
function updateTimer() {
  const elapsed = Math.floor((Date.now() - gameStartTime) / 1000);
  const hours = Math.floor(elapsed / 3600);
  const minutes = Math.floor((elapsed % 3600) / 60);
  const seconds = elapsed % 60;
  
  const formattedTime = 
    `${hours.toString().padStart(2, '0')}:` +
    `${minutes.toString().padStart(2, '0')}:` +
    `${seconds.toString().padStart(2, '0')}`;
  
  document.getElementById('game-time').textContent = `æ—¶é—´: ${formattedTime}`;
}

// é‡æ–°å¼€å§‹æ¸¸æˆ
function restartGame() {
  startGame(rows, cols, mineCount);
}

// é€€å‡ºæ¸¸æˆ
function exitGame() {
  document.getElementById('mine-game').style.display = 'none';
  if (timerInterval) clearInterval(timerInterval);
  document.getElementById('game-info-container').classList.add('hidden');
}

  </script>

</html>
